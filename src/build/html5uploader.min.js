var Html5Uploader=function(e){function t(s){if(a[s])return a[s].exports;var r=a[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var a={};return t.m=e,t.c=a,t.i=function(e){return e},t.d=function(e,a,s){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:s})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,a){var s,r;s=[a,t],void 0!==(r=function(e,t){"use strict";var a=function(){function e(e){this.objects={fileSelect:null,fileDropArea:null,submitButton:null,previewDiv:null},this.counter=0;var t=this;this.params=e,this.params.nette=!!this.params.nette&&this.params.nette,this.params.replacePreviews=!!this.params.replacePreviews&&this.params.replacePreviews,t.createMessageDiv(),this.objects.fileSelect=document.getElementById(this.params.fileSelectId),this.objects.fileSelect.addEventListener("change",function(e){t.fileSelectHandler(e)},!1),void 0!==this.params.fileSelectAliases&&this.params.fileSelectAliases.length>0&&this.params.fileSelectAliases.forEach(function(e){document.getElementById(e).addEventListener("click",function(e){t.objects.fileSelect.click()})}),this.objects.previewDiv=document.getElementById(this.params.previewDivId);var a;a=new XMLHttpRequest,a.upload&&(this.objects.fileDropArea=document.getElementById(this.params.fileDropAreaId),this.objects.fileDropArea.addEventListener("dragenter",function(e){t.fileDragHover(e)},!1),this.objects.fileDropArea.addEventListener("dragleave",function(e){t.fileDragHover(e)},!1),this.objects.fileDropArea.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()},!1),this.objects.fileDropArea.addEventListener("drop",function(e){t.fileSelectHandler(e)},!1),this.objects.fileDropArea.style.display="block",this.objects.submitButton=document.getElementById(this.params.submitButtonId),this.objects.submitButton.style.display="none")}return e.prototype.fileSelectHandler=function(e){this.fileDragHover(e),this.counter=0;for(var t=e.target.files||e.dataTransfer.files,a=0,s=void 0;s=t[a];a++)if(s.size<=this.params.maxSize)this.parseFile(s),void 0!==this.params.handlers&&void 0!==this.params.handlers.before&&this.params.handlers.before(s),this.params.nette?this.uploadFileNette(s):this.uploadFile(s),void 0!==this.params.handlers&&void 0!==this.params.handlers.after&&this.params.handlers.after(s);else{if(void 0!==this.params.progressBarDiv){var r=document.getElementById(this.params.progressBarDiv),n=document.createElement("div"),i=document.createElement("div");n.className="progressBar",r.appendChild(n),n.appendChild(i),i.className="bar",i.appendChild(document.createTextNode(s.name)),i.style.width="100%",i.className="bar failure",$(n).delay(5e3).fadeOut(300)}this.showMessage("Obrázek "+s.name+" je příliš velký.","error")}},e.prototype.fileDragHover=function(e){try{e.preventDefault(),e.stopPropagation(),"dragenter"==e.type?(this.counter++,this.objects.fileDropArea.classList.add("hover")):0===--this.counter&&this.objects.fileDropArea.classList.remove("hover")}catch(e){this.counter=0,this.objects.fileDropArea.classList.remove("hover")}},e.prototype.parseFile=function(e){if(0==e.type.indexOf("image")&&null!=this.params.previewDivId){var t=new FileReader,a=this;t.onload=function(e){a.showPreview('<img src="'+e.target.result+'" />')},t.readAsDataURL(e)}},e.prototype.uploadFile=function(e){var t=new XMLHttpRequest;if(t.upload&&("image/jpeg"==e.type||"image/png"==e.type)){if(null!=this.params.progressBarDiv){var a=document.getElementById(this.params.progressBarDiv),s=document.createElement("div"),r=document.createElement("div");s.className="progressBar",a.appendChild(s),s.appendChild(r),r.className="bar",r.style.width="0%",r.appendChild(document.createTextNode(e.name)),t.upload.addEventListener("progress",function(e){var t=100-e.loaded/e.total*100;r.style.width=t+"%"},!1),t.onprogress=function(e){var t=100-e.loaded/e.total*100;r.style.width=t+"%"},t.upload.onprogress=function(e){var t=100-e.loaded/e.total*100;r.style.width=t+"%"};var n=this;t.onreadystatechange=function(a){4==t.readyState&&(r.className=200===t.status?"bar success":"bar failure",200!==t.status&&n.showMessage("Při nahrávání obrázku "+e.name+" došlo k chybě.","error"),$(s).delay(5e3).fadeOut(600))}}var i=document.getElementById(this.params.formId);t.open("POST",i.action,!0),t.setRequestHeader("X-FILENAME",e.name),t.send(e)}},e.prototype.uploadFileNette=function(e){var t=document.getElementById(this.params.formId),a=new FormData;a.append("file-0",e);var s=$("[name=_do]",t).attr("value");a.append("_do",s);var r=this;$.ajax({xhr:function(){return r.createXhrForNette(e)},url:t.action,data:a,cache:!1,contentType:!1,processData:!1,type:"POST",beforeSend:function(e){e.setRequestHeader("X-DRAGDROP","yes")}})},e.prototype.createXhrForNette=function(e){var t=new XMLHttpRequest;if(null!=this.params.progressBarDiv){var a=document.getElementById(this.params.progressBarDiv),s=document.createElement("div"),r=document.createElement("div");s.className="upload",a.appendChild(s),s.appendChild(r),r.className="bar",r.appendChild(document.createTextNode(e.name)),t.upload.addEventListener("progress",function(e){var t=e.loaded/e.total*100;r.style.width=t+"%"},!1),t.onprogress=function(e){var t=100-e.loaded/e.total*100;r.style.width=t+"%"},t.upload.onprogress=function(e){var t=100-e.loaded/e.total*100;r.style.width=t+"%"};var n=this;t.onreadystatechange=function(a){4==t.readyState&&(r.className=200===t.status?"bar success":"bar failure",200!==t.status&&n.showMessage("Při nahrávání obrázku "+e.name+" došlo k chybě.","error"),$(s).delay(5e3).fadeOut(600))}}return t},e.prototype.showPreview=function(e){this.params.replacePreviews?this.objects.previewDiv.innerHTML=e:this.objects.previewDiv.innerHTML=this.objects.previewDiv.innerHTML+e},e.prototype.createMessageDiv=function(){if(!this.params.nette){var e=document.getElementById("uploaderMessages");null===e&&(e=document.createElement("div"),e.id="uploaderMessages",document.body.appendChild(e))}},e.prototype.showMessage=function(e,t){var a=document.createElement("p");if(this.params.nette){var s=void 0;a.textContent=e;var r=document.createElement("div");if(r.className="flashMessage "+t,r.appendChild(a),0===document.getElementsByClassName("flashMessages").length){s=document.createElement("section"),s.className="flashMessages";var n=void 0;null!==(n=document.getElementById("snippet--flashMessages"))?n.appendChild(s):document.body.appendChild(s)}else s=document.getElementsByClassName("flashMessages")[0];s.appendChild(r)}else{a.textContent=e;var i=document.createElement("div");i.className="message",i.appendChild(a);document.getElementById("uploaderMessages").appendChild(i)}},e}();t.uploader=a}.apply(t,s))&&(e.exports=r)}]);