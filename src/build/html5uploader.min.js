var Html5Uploader=function(e){var t={};function r(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(a,s,function(t){return e[t]}.bind(null,s));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){var a;void 0===(a=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.filesCounter=0,this.filesCount=0,this.params=e,this.params.replacePreviews=!!this.params.replacePreviews&&this.params.replacePreviews,this.elemPreview=document.getElementById(this.params.previewDivId),this.elemFileSelect=document.getElementById(this.params.fileSelectId),this.elemFileDropArea=document.getElementById(this.params.fileDropAreaId),this.elemSubmitBtn=document.getElementById(this.params.submitButtonId),this.setEventListeners()}return e.prototype.setEventListeners=function(){var e=this;this.elemFileSelect.addEventListener("change",function(t){e.fileSelectHandler(t)}),void 0!==this.params.fileSelectAliases&&this.params.fileSelectAliases.length>0&&this.params.fileSelectAliases.forEach(function(t){document.getElementById(t).addEventListener("click",function(){e.elemFileSelect.click()})}),(new XMLHttpRequest).upload&&(this.elemFileDropArea.addEventListener("dragenter",function(t){e.addHover(t)}),this.elemFileDropArea.addEventListener("dragleave",function(t){e.removeHover(t)}),this.elemFileDropArea.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()}),this.elemFileDropArea.addEventListener("drop",function(t){e.fileSelectHandler(t)}),this.elemFileDropArea.style.display="block",this.elemSubmitBtn.style.display="none")},e.prototype.fileSelectHandler=function(e){this.removeHover(e);var t=e.target.files||e.dataTransfer.files;this.filesCount=t.length,void 0!==this.params.handlers&&void 0!==this.params.handlers.before&&this.params.handlers.before();for(var r=0,a=t;r<a.length;r++){var s=a[r];if(s.size<=this.params.maxSize)this.parseFile(s),this.uploadFile(s);else{if(void 0!==this.params.progressBarDiv){var n=this.createProgressBar(s.name);n.style.width="100%",n.className="bar failure",this.removeProgressBar(n)}this.showMessage("Obrázek "+s.name+" je příliš velký.","error")}}},e.prototype.parseFile=function(e){var t=this;if(0===e.type.indexOf("image")&&null!==this.params.previewDivId){var r=new FileReader;r.onload=function(){t.showPreview(r.result.toString())},r.readAsDataURL(e)}},e.prototype.uploadFile=function(e){var t=this,r=document.getElementById(this.params.formId);if("image/jpeg"===e.type||"image/png"===e.type){var a=new FormData;a.append("file-0",e);var s=$("[name=_do]",r).attr("value");a.append("_do",s),$.ajax({xhr:function(){return t.createXhr(e)},url:r.action,data:a,cache:!1,contentType:!1,processData:!1,type:"POST",beforeSend:function(t){t.setRequestHeader("X-DRAGDROP","yes"),t.setRequestHeader("X-FILENAME",e.name.toLocaleLowerCase())}})}else this.showMessage("Neplatný formát obrázku.","error")},e.prototype.createXhr=function(e){var t=this,r=new XMLHttpRequest;if(null!==this.params.progressBarDiv){var a=this.createProgressBar(e.name);r.upload.addEventListener("progress",function(e){a.style.width=e.loaded/e.total*100+"%"}),r.onprogress=function(e){a.style.width=e.loaded/e.total*100+"%"},r.upload.onprogress=function(e){a.style.width=e.loaded/e.total*100+"%"},r.onreadystatechange=function(){4===r.readyState&&(a.className=200===r.status?"bar success":"bar failure",a.style.width="100%",200!==r.status&&t.showMessage("Při nahrávání obrázku "+e.name+" došlo k chybě.","error"),t.removeProgressBar(a),t.afterHandler())}}return r},e.prototype.showPreview=function(e){this.params.replacePreviews?this.elemPreview.innerHTML="<img src='"+e+"'>":this.elemPreview.innerHTML=this.elemPreview.innerHTML+"<img src='"+e+"'>"},e.prototype.showMessage=function(e,t){if(void 0!==this.params.flashHandler)this.params.flashHandler(e,t);else{var r=document.createElement("p");r.textContent=e;var a=void 0,s=document.createElement("div");if(s.className="flashMessage "+t,s.appendChild(r),0===document.getElementsByClassName("flashMessages").length){(a=document.createElement("section")).className="flashMessages";var n=document.getElementById("snippet--flashMessages");void 0!==typeof n&&null!==n?n.appendChild(a):document.body.appendChild(a)}else a=document.getElementsByClassName("flashMessages")[0];a.appendChild(s)}},e.prototype.afterHandler=function(){this.filesCounter++,this.filesCount===this.filesCounter&&void 0!==this.params.handlers&&void 0!==this.params.handlers.after&&this.params.handlers.after()},e.prototype.addHover=function(e){e.preventDefault(),e.stopPropagation(),this.elemFileDropArea.classList.add("hover")},e.prototype.removeHover=function(e){e.preventDefault(),e.stopPropagation(),this.elemFileDropArea.classList.remove("hover")},e.prototype.createProgressBar=function(e){var t=document.getElementById(this.params.progressBarDiv),r=document.createElement("div"),a=document.createElement("div");return r.className="upload",t.appendChild(r),r.appendChild(a),a.className="bar",a.appendChild(document.createTextNode(e)),a},e.prototype.removeProgressBar=function(e){$(e.parentElement).delay(5e3).fadeOut(600,function(){e.parentElement.remove()})},e}();t.Html5uploader=r}.apply(t,[r,t]))||(e.exports=a)}]);