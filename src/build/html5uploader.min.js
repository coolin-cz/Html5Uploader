var Html5Uploader;(()=>{var e={87:(e,t,a)=>{var r;r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Html5uploader=void 0;var a=function(){function e(e){this.filesCounter=0,this.filesCount=0,this.counter=0,this.params=e,this.params.replacePreviews=!!this.params.replacePreviews&&this.params.replacePreviews,this.elemPreview=document.getElementById(this.params.previewDivId),this.elemFileSelect=document.getElementById(this.params.fileSelectId),this.elemFileDropArea=document.getElementById(this.params.fileDropAreaId),this.elemSubmitBtn=document.getElementById(this.params.submitButtonId),this.setEventListeners()}return e.prototype.setEventListeners=function(){var e=this;this.elemFileSelect.addEventListener("change",(function(t){e.fileSelectHandler(t)})),void 0!==this.params.fileSelectAliases&&this.params.fileSelectAliases.length>0&&this.params.fileSelectAliases.forEach((function(t){document.getElementById(t).addEventListener("click",(function(){e.elemFileSelect.click()}))})),(new XMLHttpRequest).upload&&(this.elemFileDropArea.addEventListener("dragenter",(function(t){e.addHover(t)})),this.elemFileDropArea.addEventListener("dragleave",(function(t){e.removeHover(t)})),this.elemFileDropArea.addEventListener("dragover",(function(e){e.preventDefault(),e.stopPropagation()})),this.elemFileDropArea.addEventListener("drop",(function(t){e.fileSelectHandler(t)})),this.elemFileDropArea.style.display="block",this.elemSubmitBtn.style.display="none")},e.prototype.fileSelectHandler=function(e){this.removeHover(e),this.counter=0;var t=e.target.files||e.dataTransfer.files;this.filesCount=t.length,void 0!==this.params.handlers&&void 0!==this.params.handlers.before&&this.params.handlers.before();for(var a=0,r=t;a<r.length;a++){var s=r[a];if(s.size<=this.params.maxSize)this.parseFile(s),this.uploadFile(s);else{if(void 0!==this.params.progressBarDiv){var i=this.createProgressBar(s.name);i.style.width="100%",i.className="bar failure",this.removeProgressBar(i)}this.showMessage("Obrázek "+s.name+" je příliš velký.","error")}}},e.prototype.parseFile=function(e){var t=this;if(0===e.type.indexOf("image")&&null!==this.params.previewDivId){var a=new FileReader;a.onload=function(){t.showPreview(a.result.toString())},a.readAsDataURL(e)}},e.prototype.uploadFile=function(e){var t=this,a=document.getElementById(this.params.formId);if("image/jpeg"===e.type||"image/png"===e.type){var r=new FormData;r.append("file-0",e);var s=$("[name=_do]",a).attr("value");r.append("_do",s),$.ajax({xhr:function(){return t.createXhr(e)},url:a.action,data:r,cache:!1,contentType:!1,processData:!1,type:"POST",beforeSend:function(t){t.setRequestHeader("X-DRAGDROP","yes"),t.setRequestHeader("X-FILENAME",encodeURIComponent(e.name.toLocaleLowerCase()))}})}else this.showMessage("Neplatný formát obrázku.","error"),setTimeout((function(){t.afterHandler()}),500)},e.prototype.createXhr=function(e){var t=this,a=new XMLHttpRequest;if(null!==this.params.progressBarDiv){var r=this.createProgressBar(e.name);a.upload.addEventListener("progress",(function(e){r.style.width=e.loaded/e.total*100+"%"})),a.onprogress=function(e){r.style.width=e.loaded/e.total*100+"%"},a.upload.onprogress=function(e){r.style.width=e.loaded/e.total*100+"%"},a.onreadystatechange=function(){4===a.readyState&&(r.className=200===a.status?"bar success":"bar failure",r.style.width="100%",200!==a.status&&t.showMessage("Při nahrávání obrázku "+e.name+" došlo k chybě.","error"),t.removeProgressBar(r),t.afterHandler())}}return a},e.prototype.showPreview=function(e){this.params.replacePreviews&&(this.elemPreview.innerHTML="");var t=document.createElement("div");t.className="preview";var a=document.createElement("img");if(a.setAttribute("src",e),t.appendChild(a),void 0!==this.params.loaderClass){var r=document.createElement("i");r.className=this.params.loaderClass,t.appendChild(r)}return this.elemPreview.appendChild(t),t},e.prototype.showMessage=function(e,t){if(void 0!==this.params.flashHandler)this.params.flashHandler(e,t);else{var a=document.createElement("p");a.textContent=e;var r=void 0,s=document.createElement("div");if(s.className="flashMessage "+t,s.appendChild(a),0===document.getElementsByClassName("flashMessages").length){(r=document.createElement("section")).className="flashMessages";var i=document.getElementById("snippet--flashMessages");void 0!==typeof i&&null!==i?i.appendChild(r):document.body.appendChild(r)}else r=document.getElementsByClassName("flashMessages")[0];r.appendChild(s)}},e.prototype.afterHandler=function(){this.filesCounter++,this.filesCount===this.filesCounter&&void 0!==this.params.handlers&&void 0!==this.params.handlers.after&&(this.filesCounter=0,this.params.handlers.after())},e.prototype.addHover=function(e){e.preventDefault(),e.stopPropagation(),this.counter++,this.elemFileDropArea.classList.add("hover")},e.prototype.removeHover=function(e){e.preventDefault(),e.stopPropagation(),this.counter--,0===this.counter&&this.elemFileDropArea.classList.remove("hover")},e.prototype.createProgressBar=function(e){var t=document.getElementById(this.params.progressBarDiv),a=document.createElement("div"),r=document.createElement("div");return a.className="upload",t.appendChild(a),a.appendChild(r),r.className="bar",r.appendChild(document.createTextNode(e)),r},e.prototype.removeProgressBar=function(e){$(e.parentElement).delay(5e3).fadeOut(600,(function(){e.parentElement.remove()}))},e}();t.Html5uploader=a}.apply(t,[a,t]),void 0===r||(e.exports=r)}},t={};var a=function a(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,a),i.exports}(87);Html5Uploader=a})();